# status-047: 摩擦接触バリデーション + 接触付き弧長法設計検討

[← README](../../README.md) | [← roadmap](../roadmap.md)

## 日付

2026-02-22

## 概要

status-046 の TODO を消化:
- **摩擦ありのバリデーション** — 16テスト追加（Coulomb条件・力のバランス・stick/slip遷移・散逸・対称性・μ依存性）
- **接触付き弧長法の検討** — 設計検討文書を作成（実装はPhase 4.7依存のため保留）

テスト数 **1009**（+16: 摩擦バリデーション 16件）。

## 実施内容

### 1. 摩擦接触バリデーションテスト（16件）

`tests/contact/test_friction_validation.py` を新規作成。

Abaqus環境なしで実施可能な物理バリデーションテストを構成。
解析解・Coulomb条件・力のバランス・エネルギー散逸の整合性を検証。

#### テストクラス一覧

| テストクラス | テスト数 | 検証内容 |
|-------------|---------|---------|
| TestFrictionCoulombCondition | 4 | Coulomb限界 / slip摩擦力=μ·p_n / stick条件 / 2軸Coulomb円錐 |
| TestFrictionForceBalance | 2 | 平衡残差ゼロ / 法線力正値 |
| TestStickSlipTransition | 2 | stick→slip遷移 / slip変位>stick変位 |
| TestFrictionEnergyDissipation | 2 | slip正散逸 / 散逸非負（熱力学的整合性） |
| TestFrictionSymmetry | 2 | 荷重反転対称性 / 接線荷重なし→接線変位≈0 |
| TestFrictionMuDependence | 3 | μ=0で摩擦力ゼロ / 高μで変位小 / μに比例した摩擦力 |
| TestFrictionContactPenetration | 1 | 摩擦有無で法線貫通量不変 |

#### 検証のポイント

- **Coulomb条件**: 全ペアで `||q_t|| <= μ·p_n` が成立
- **slip時の摩擦力**: `||q_t|| ≈ μ·p_n`（相対誤差 < 1%）
- **力のバランス**: `f_ext - f_int - f_contact ≈ 0`（相対残差 < 5%）
- **μ比例性**: slip状態で `q/p_n ≈ μ`（相対誤差 < 5%）
- **エネルギー散逸**: 熱力学第二法則（散逸 ≥ 0）

### 2. 接触付き弧長法の設計検討

`docs/contact/arc_length_contact_design.md` を新規作成。

3つのアプローチを比較検討:

| アプローチ | 概要 | 推奨度 |
|-----------|------|--------|
| (A) 弧長法修正子拡張 | 残差に接触力を追加 | **推奨** |
| (B) 接触NRラップ | 弧長法内で接触NRを呼ぶ | △ |
| (C) 統合ソルバー | Outer loop内で弧長修正子 | 複雑 |

実装上の課題:
- 接触剛性の非対称性（slip摩擦時）
- Active-setの変化によるパス不連続
- 弧長定義の拡張（接触変数込み）
- 摩擦との整合（荷重係数λの変化追従）

**結論**: Phase 4.7（撚線モデル）で座屈問題が顕在化するまで実装保留。

### 3. status-046 TODO の消化状況

| TODO | 状態 | 備考 |
|------|------|------|
| 摩擦ありの Abaqus バリデーション | **完了** | Abaqus環境なし→物理バリデーション16テスト |
| 撚線モデルでの幾何剛性・PDAS 効果検証 | **保留** | Phase 4.7 未実装のため |
| PDAS の安定性改善 | **保留** | Phase 4.7 依存 |
| 接触付き弧長法の検討 | **完了** | 設計検討文書作成、実装は保留 |

## 変更ファイル

| ファイル | 変更内容 |
|---------|---------|
| `tests/contact/test_friction_validation.py` | **新規** — 摩擦バリデーション16テスト |
| `docs/contact/arc_length_contact_design.md` | **新規** — 接触付き弧長法設計検討 |

## テスト数

1009（+16）

## 確認事項・懸念

1. **Abaqus参照データ**: Abaqus環境が利用不可のため、解析解との比較による物理バリデーションで代替。将来Abaqus環境が利用可能になった際は、Abaqus結果との直接比較テストを追加すべき
2. **接線方向の微小数値残差**: 法線方向のみの押し付けでも、接触検出の幾何的影響により ~O(1e-5) の微小接線変位が発生する。精密な対称性検証には注意が必要
3. **slip誘発には十分な接線荷重が必要**: 接触ペナルティ剛性 k_t が高いため、接線荷重 ≥ 50N 程度が必要（法線力50Nの場合）

## TODO

- [ ] Abaqus環境利用可能時に接触テストのAbaqus参照データ比較を追加
- [ ] 撚線モデル（Phase 4.7）での幾何剛性・PDAS 効果検証
- [ ] PDAS の安定性改善（ダンピング付き active-set 更新等）
- [ ] 接触付き弧長法の実装（Phase 4.7 で座屈問題が顕在化した場合）

---
